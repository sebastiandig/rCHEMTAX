---
title: "CHEMTAX Main"
author: "Sebastian DiGeronimo"
date: "6/2/2022"
output:
  html_document: default
  pdf_document: default
---

### Intro: 
This will serve as my starting point for converting CHEMTAX V2.0 into R.
#TODO: fix this: [CHEMTAX Document](./Re__CHEMTAX_Update_[SEC=OFFICIAL]/Re__CHEMTAX_Update_[SEC=OFFICIAL]/CHEMTAX 2 Octave version.docx)

`r gsub("\\.m$","", list.files(path = "./Re__CHEMTAX_Update_[SEC=OFFICIAL]/MatrixFactorsOctave/", pattern="\\.m$"))`
# Files that need to be converted
double tilde ~ will show done

22 - not all are .m files with functions
7 mostly done
* "adddir"                        ----

* "amatfactsd"                    ---- mostly done
                                       * TODO: lsqnonneg

* "bmatfactsd"                    ---- mostly done 
                                       * TODO: lsqnonneg

* "bootln"                        ---- mostly done 
                                       * connected to `nnmatfactsd`

* "bootnp"                        ---- mostly done 
                                       * connected to `nnmatfactsd`

* "brokewest"                     ---- mostly done 
                                      * connected to `chemtaxbrokewest`, 
                                      `nnmatfactsd`,  `normprod`, `regplot`, 
                                      `randstart`, `bootln`, `bootnp`

* "chemtaxbrokewest"              ---- finished 
                                       * connected to `permcalc`, file for `s`  
                                        and `scol` as `CHEMTAXBROKEWests`, file    
                                        for `f0`, `taxa` and `fcol` as 
                                        `pigment_ratios.csv`

* "CHEMTAXBROKEWestb"             ---- mostly done 
                                       * connected to `matfactuvw`, `permcalc`,
                                        file for `b` as `b_pigment_ratios.csv`, 
                                        file for `x` as `CHEMTAXBROKEWestx.csv``

* "CHEMTAXBROKEWests"             ---- * finished, as .csv in `data/raw/`  

* "CHEMTAXBROKEWestx"             ---- * finished, as .csv in `data/raw/`

* "dataout"                       ---- 
                                       probably don't need     

* "Formulas"                      ---- * finished, doesn't connect to anything and 
                                       is not a function, not sure what do do with it
                                       
* "initstruct"                    ---- * finished    

* "matfactuvw"                    ---- 
                                       * connected to  `initstruct`

* "nnmatfactsd"                   ----        

* "normprod"                      ---- 

* "permcalc"                      ---- * finished       

* "randstart"                     ---- 

* "regplot"                       ---- 
                                       * connected to `nnmatfactsd`

* "saz"                           ---- mostly done 
                                      * connected to `sazchemtax090210`, 
                                      `nnmatfactsd`,  `normprod`, `regplot`, 
                                      `randstart`, `bootln`, `bootnp`

* "sazchemtax090210"              ----  * finished 
                                        * connected to `permcalc`, file for `s`  
                                        and `scol` as `SAZS_CHEMTAX090210s.csv`, 
                                        file for `f0`, `taxa` and `fcol` as 
                                        `saz_pigment_ratios.csv`

* "SAZS_CHEMTAX090210s"           ---- * finished, as .csv in `data/raw/`


# Matlab notes:
* length(x) = largest of the dimensions, so if 100 x 4 = 100, or 4 x 100 = 100
* `*` is matrix multiply, 
* `.*` & `./` are matrix element by element multiply & divide operations


#TODO: something to include is:
This would load internal ratios file so that you have a basic pigment ratio var
pigment_ratio <- system.file("", package = "rCHEMTAX")

Plotting Log function:
# allow y log style plotting from Matlab in semilogy
  fancy_scientific <- function(l) {
    # turn in to character string in scientific notation
    l <- format(l, scientific = TRUE)
    # quote the part before the exponent to keep all the digits
    l <- gsub("^(.*)e", "'\\1'e", l)
    # turn the 'e+' into plotmath format
    l <- gsub("e", "%*%10^", l)
    # return this as an expression
    parse(text=l)
  }
  
  yticks = outer((1:10),(10^(-5:-1)))
  xticks = outer((1:10),(10^(0:1)))
  
  include either:
  * semiolgx
  scale_x_log10(limits = c(1, 100),
                labels = fancy_scientific,
                minor_breaks = xticks) +
  * semilogy
  scale_y_log10(limits = c(1e-5, 1),
                labels = fancy_scientific,
                minor_breaks = yticks) +
    
## Section 1: Setup

```{r setup, include=FALSE, message=FALSE}
root <- rprojroot::find_rstudio_root_file()
library("knitr")
knitr::opts_chunk$set(echo = TRUE)
knitr::opts_knit$set(root.dir = root)
library("tidyverse")
library("dplyr")
library("lubridate")
library("vroom")


```

```{r create-dir}
# will create a set directory if does not exists
# useful for new projects
mainDir <- rprojroot::find_rstudio_root_file()
subDir <-
    c("data/raw",
      "data/processed",
      "data/plots",
      "data/metadata",
      "Rmd",
      "scripts")

fs::dir_create(path = paste0(mainDir,"/",subDir))
rm(mainDir, subDir)
```

this is a test help me
```{r}
readr::read_csv("./data/raw/SAZS_CHEMTAX090210s.csv")
```

